<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gol! - Copa PC</title>
<link href="/copa-web/resources/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="control-group form-group">
          <div class="controls">
            <label>Jogo</label>
            <select id="jogos" class="form-control"></select>
          </div>
        </div>
        <div class="control-group form-group">
          <div class="controls">
            <label>Jogadores</label>
            <select id="jogadores" class="form-control"></select>
          </div>
        </div>
        <ul id="myTab" class="nav nav-tabs">
          <li class="active">
            <a href="#service-one" data-toggle="tab">GOL</a>
          </li>
          <li class="">
            <a href="#service-two" data-toggle="tab">CARTÃO</a>
          </li>
        </ul>
        <div id="myTabContent" class="tab-content">
          <div class="tab-pane fade active in" id="service-one">
            <div class="form-group" style="margin-top: 20px;">
              <div class="checkbox" style="margin: 30px;">
                <label>
                  <input id="contra" type="checkbox" /> Contra
                </label>
              </div>
            </div>
            <div class="form-group">
              <div class="controls">
                <button id="gol" type="submit" class="btn btn-success btn-lg btn-block">GOL</button>
              </div>
            </div>
          </div>
          <div class="tab-pane fade" id="service-two">
            <div class="form-group" style="margin-top: 20px;">
              <div id="cartoes" class="controls" style="margin: 30px 0px;">
                <select class="form-control">
                  <option value="AMARELO">Amarelo</option>
                  <option value="VERMELHO">Vermelho</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <div class="form-group">
                <div class="controls">
                  <button id="cartao" type="submit" class="btn btn-danger btn-lg btn-block">Confirmar</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="/copa-web/resources/js/jquery.min.js"></script>
  <script src="/copa-web/resources/js/bootstrap.min.js"></script>
  <script>
		$("#gol").click(function() {
            var msg = 'Confimar gol de: ' + $("#jogadores option:selected").text();
			if (confirm(msg)) {
                var gol = {"jogador": $('#jogadores').val(), "jogo": $('#jogos').val(), "contra": $('#contra').is(':checked')};
                $.ajax({
                  url:"/copa-web/rest/jogos/gol",
                  type:"post",
                  data: JSON.stringify(gol),
                  contentType:"application/json",
                  success: function(data, status, jqXHR){
                    alert(data);
                  },
                  error: function(jqXHR, status, error) {
                	alert(status);
                  }
                });
			}
		});
		$("#cartao").click(function() {
			var msg = 'Confimar cartão (' + $("#cartoes option:selected").text() + ') de: ' + $("#jogadores option:selected").text();
			if (confirm(msg)) {
				$.post("/copa-web/rest/jogos/cartao", { jogador: $("#jogadores").val(), cartao: $("#cartoes").val() })
				.done(function() {
					alert("Ação realizada com sucesso!");
				})
				.fail(function() {
					alert("Erro ao realizar operação!");
				});
			}
		});
		$("#jogos").change(function() {
			var jogo = $("#jogos").val();
			var url = "/copa-web/rest/jogos/".concat(jogo);
			$.get(url, function(data){
				$("#jogadores option").remove();
				$.each(data, function(index, j) {
					$("#jogadores").append('<option value=' + j.email + '>' + j.nome + ' (' + j.time + ')</option>');
				});
			}).fail(function() {
				alert("Não foi possível obter os jogadores!");
			});
		});
		$(document).ready(function() {
			$.get("/copa-web/rest/jogos/abertos", function(data){
				$("#jogos option").remove();
				$.each(data, function(index, j) {
					$("#jogos").append(
						$("<option></option>").text(j.mandante.nome + ' X ' + j.visitante.nome + ', ' + j.horario).val(j.numero)
					);
				});
				$("#jogos").change();
			}).fail(function() {
				alert("Não foi possível obter os jogos!");
			});
		});
	</script>
</body>
</html>
